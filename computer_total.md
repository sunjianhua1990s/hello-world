计算机系统漫游
=================

###编译系统
1. ** 预处理阶段**：预处理器根据以字符#开头的命令，修改原始的C程序文件。包括头文件的引用（将其插入到程序文本中）、宏定义（替换）。生成 .i 文件扩展名文件。

2. **编译阶段**：编译器将文本文件.i 翻译成文本文件.s，它包含一个汇编语言程序。

3. **汇编阶段**：汇编器将.s 文件翻译成机器语言指令，并将这些指定打包成“可重定位目标程序”的格式，并将结果保存在目标文件.o 中。

4. **链接阶段**：将系统函数或者头文件中的函数的.o与我们的.o 合并，得到可执行目标程序。可以被加载到内存中，由系统执行。

###运行程序
1. shell是一个命令行解释器，它输出一个提示符，等待你输入一个命令行，然后执行这个命令。如果该命令的第一个单词不是一个内置的外壳命令，那么shell假设这是一个可执行文件的名字，它将加载并运行这个文件。
2. 目标程序的代码和数据将从存储器加载到主存，处理器就开始执行目标程序的main程序中的机器语言指令。这些将指令"hello world\n"字符串中的字节从主存复制到寄存器文件，再从寄存器文件复制到显示设备中，最终显示在屏幕上。

###系统硬件组成
1. 总线：携带信息字节并负责在各个部件间传递。总线被设计成传送定长的字节块，也就是字。字的字节数（即字长）是一个基本的系统参数.32位系统/64位系统指的就是系统总线大小。
2.  I/O设备：系统与外界设备的联系通道，如鼠标、键盘、显示器、磁盘。每个I/O设备通过控制器或者设备器与总线相连，其中控制器是置于I/O涉笔本省或者系统的主印制电路板上，而而适配器则是插在主板插槽上的卡。如USB控制器、磁盘控制器、图形适配器。
3. 主存：从物理上来说，主存时由一组动态随即存储器DRAM芯片组成，逻辑上来说，存储器是一个线性的字节数组。，每个字节都有唯一的地址，地址从0开始。
4. 处理器：处理器的核心是一个字长的存储设备（或寄存器），成为程序计数器PC，在任何时刻，PC都指向机器中的某条机器指令（即含有该条指令的地址）。CPU在指令的要求下可能会有以下 操作：（1）加载，把一个字或字节从主存复制到寄存器，已覆盖原来的内容。（2）存储，把一个字或字节从寄存器复制到主存的某个位置，以覆盖该位置上原来的内容。（3）操作，把两个寄存器的内容复制到算术逻辑单元ALU，ALU对这两个字做算术操作，并将结果存放到一个寄存器，以覆盖寄存器原来内容。（3）跳转，从指令本身提取一个字，并将这个字复制到程序计数器中，以覆盖PC中原来的字值。

###高速缓存
1. L0寄存器，CPU寄存器保存来自高速缓存存储器的字
2. L1高速缓存，静态随机访问存储器SRAM
3. L2高速缓存SRAM，通过一跳特殊的总线连接到处理器
4. L3高速缓存，SRAM，
5. 主存
6. 本地二级存储，本地磁盘
7. 远程二级存储，分布式文件系统，Web服务器

###操作系统管理硬件
1. 两大功能：（1）防止硬件被失控的应用程序滥用；（2）向应用程序提供简单一致的机制来控制复杂而又通常大相径庭的低级硬件设备。通过抽象概念实现功能。
2. **文件**是对I/O设备的抽象；**虚拟存储器**是对主存和磁盘I/O设备的抽象；**进程**是对处理器、主存和磁盘I/O设备的抽象；**指令集**是对处理器的抽象，**虚拟机**提供堆整个计算机（包括操作系统、处理器、程序）的抽象。

###虚拟存储器
1. 一个抽象的概念，为每个进程提供一个假象，即每个进程都独占的使用内存。每个进程看到的时一致的存储器，成为虚拟地址空间。在Linux中地址空间最上面的区域时OS中的代码和数据保留，对每个进程都是一致。地址空间的地步区域存放用户进程定义的代码和数据。
2. 进程的虚拟地址空间，从下到上依次是：**只读的程序代码和数据**，**运行时的堆（malloc）**，**共享库的存储器映射区域（printf函数）**，**用户栈**，**内核虚拟存储器**。

